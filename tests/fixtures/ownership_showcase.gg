# Ownership showcase â€” message pipeline with borrow, mutable borrow, and move

struct Message:
    str sender
    str subject
    int priority

void preview(Message msg):
    print("{msg.sender} {msg.subject} {msg.priority}")

void send(Message !msg):
    print("sent {msg.subject} by {msg.sender}")

equip Message:
    void set_priority(&self, int new_priority):
        self.priority = new_priority

void main():
    # Copy types flow freely
    int priority = 3
    int backup = priority
    print("{priority}")
    print("{backup}")

    # Create and borrow
    Message msg = Message("Alice", "Hello", 1)
    preview(msg)
    print("alive")

    # Mutable borrow via method
    msg.set_priority(5)
    preview(msg)

    # Move consumes
    send(!msg)

    # Reassignment revives
    msg = Message("Bob", "Reply", 2)
    preview(msg)
    print("done")
