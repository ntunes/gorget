void main():
    int x = 10
    GorgetClosure add_x = (int y): x + y
    int result = add_x(5)
    print("{result}")

    int result2 = add_x(20)
    print("{result2}")

    auto sum_with = (int a, int b): a + b + x
    int result3 = sum_with(3, 7)
    print("{result3}")

    auto get_x = (): x
    int result4 = get_x()
    print("{result4}")

    int result5 = add_x(1) + 100
    print("{result5}")

    add_x(0)

    int(int) double_fn = (int y): y * 2

    # Untyped closure parameters (type inference)
    auto add = (a, b): a + b
    int inferred_sum = add(3, 4)
    print("{inferred_sum}")

    auto negate = (n): 0 - n
    int neg_result = negate(42)
    print("{neg_result}")

    # Mutable capture: mutation propagates to outer scope
    int count = 0
    auto increment = ():
        count = count + 1
    increment()
    increment()
    increment()
    print("{count}")

    # Compound assignment mutable capture
    int total = 0
    auto accumulate = (int n):
        total += n
    accumulate(10)
    accumulate(20)
    accumulate(30)
    print("{total}")

    # Mixed captures: some mutable, some immutable
    int base = 100
    int accum = 0
    auto add_to_accum = (int n):
        accum += base + n
    add_to_accum(1)
    add_to_accum(2)
    print("{accum}")

    print("closures")
